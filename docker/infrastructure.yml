services:
 fws-app-redis:
  container_name: fws-app-redis
  image: redis:8.2-alpine
  ports:
    - "6379:6379"
  deploy:
    restart_policy:
      condition: on-failure
  networks:
    - default
    - localstack
  healthcheck:
    test: ["CMD", "redis-cli", "ping"]
    interval: 5s
    timeout: 5s
    retries: 10

 fws-app:
  container_name: fws-app
  build:
    context: ..
    target: development
  ports:
    - "3000:3000"
  env_file:
    - .env
  depends_on:
    fws-app-redis:
      condition: service_healthy
  networks:
    - default
    - localstack
  deploy:
    restart_policy:
      condition: on-failure

networks:
  localstack:
    external: true
    name: docker_ls    
    